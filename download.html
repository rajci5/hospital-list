<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Hospital Directory - Free Hospital Directory India</title>
    <meta name="description" content="Download your customized PDF list of free hospitals. Government and charitable hospitals with complete contact information.">
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXX" crossorigin="anonymous"></script>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header Ad -->
        <div class="ad-banner">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-XXXXXXXXXX"
                 data-ad-slot="XXXXXXXXXX"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>

        <div class="header">
            <h1>üè• Free Hospital Directory India</h1>
            <p>Find government and charitable hospitals providing free treatment</p>
        </div>

        <!-- Step Indicator -->
        <div class="step-indicator">
            <div class="step completed">1</div>
            <div class="step completed">2</div>
            <div class="step active">3</div>
        </div>

        <!-- Page 3: Download Page -->
        <div class="content-card">
            <div class="loading" id="loading" style="display: block;">
                <div class="spinner"></div>
                <p>Preparing your customized hospital list...</p>
            </div>

            <div id="downloadContent" style="display: none;">
                <h2>üéâ Your Hospital Directory is Ready!</h2>
                <p style="margin-bottom: 30px; color: #6c757d; font-size: 1.1rem;">
                    Download your comprehensive PDF list of free hospitals in <span id="selectedState"></span>.
                </p>

                <div class="preview-box">
                    <h4>üìä Your customized report includes:</h4>
                    <div class="hospital-item">‚úÖ <span id="hospitalCount">150+</span> verified hospitals</div>
                    <div class="hospital-item">‚úÖ Complete contact information</div>
                    <div class="hospital-item">‚úÖ Organized by location</div>
                    <div class="hospital-item">‚úÖ Free treatment availability details</div>
                    <div class="hospital-item">‚úÖ Emergency contact numbers</div>
                </div>

                <!-- Final Ad before download -->
                <div class="ad-banner">
                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-client="ca-pub-XXXXXXXXXX"
                         data-ad-slot="XXXXXXXXXX"
                         data-ad-format="auto"
                         data-full-width-responsive="true"></ins>
                </div>

                <button class="btn btn-download" onclick="downloadPDF()">
                    üì• Download Hospital Directory PDF
                </button>
                
                <p style="margin-top: 20px; color: #6c757d; font-size: 0.9rem;">
                    ‚ö° Instant download ‚Ä¢ üì± Mobile friendly ‚Ä¢ üîÑ Updated monthly
                </p>

                <a href="index.html" class="btn btn-secondary">
                    üîÑ Get Directory for Another State
                </a>
            </div>
        </div>

        <!-- Bottom Ad -->
        <div class="ad-banner">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-XXXXXXXXXX"
                 data-ad-slot="XXXXXXXXXX"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>
    </div>

    <!-- Sidebar Ad -->
    <div class="sidebar">
        <div class="ad-banner" style="margin: 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-XXXXXXXXXX"
                 data-ad-slot="XXXXXXXXXX"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>
    </div>

    <!-- Popup Overlay -->
    <div class="popup-overlay" id="popupOverlay">
        <div class="popup">
            <button class="close-popup" onclick="closePopup()">&times;</button>
            <h3 style="margin-bottom: 20px; color: #2c3e50;">üöÄ Special Offer!</h3>
            <p style="margin-bottom: 20px;">Get instant access to our premium hospital directory with exclusive features!</p>
            
            <!-- Popup Ad Space -->
            <div class="ad-banner" style="margin: 15px 0; min-height: 80px;">
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-XXXXXXXXXX"
                     data-ad-slot="XXXXXXXXXX"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
            </div>
            
            <button class="btn" onclick="closePopup()" style="margin: 10px;">
                Continue to Download
            </button>
        </div>
    </div>

    <script>
        window.console = window.console || { log: function() {}, error: function() {} };
        let hasShownScrollPopup = false;
        let hasShownExitPopup = false;

        // Get parameters from URL
        const urlParams = new URLSearchParams(window.location.search);
        const selectedState = urlParams.get('state');
        const selectedDistrict = urlParams.get('district');
        const selectedPincode = urlParams.get('pincode');

        // Show loading and prepare download
        function showLoadingAndPrepareDownload() {
            console.log('Starting loading process...');
            const loadingElement = document.getElementById('loading');
            const downloadElement = document.getElementById('downloadContent');
            
            console.log('Loading element:', loadingElement);
            console.log('Download element:', downloadElement);
            
            if (loadingElement && downloadElement) {
                loadingElement.style.display = 'block';
                downloadElement.style.display = 'none';
                console.log('Elements visibility set');
                
                // Simulate processing time with shorter delay for mobile
                const isMobile = window.innerWidth <= 768;
                const delay = isMobile ? 1500 : 2000;
                
                setTimeout(() => {
                    console.log('Showing download content...');
                    loadingElement.style.display = 'none';
                    downloadElement.style.display = 'block';
                    
                    // Update dynamic content
                    updateStateDisplay();
                    
                    // Trigger scroll popup after a delay
                    setTimeout(() => {
                        if (!hasShownScrollPopup) {
                            showScrollPopup();
                        }
                    }, 3000);
                }, delay);
            } else {
                console.error('Loading or download content elements not found');
                console.error('Loading element found:', !!loadingElement);
                console.error('Download element found:', !!downloadElement);
            }
        }
        
        function updateStateDisplay() {
            const stateNames = {
                    'andhra-pradesh': 'Andhra Pradesh',
                    'arunachal-pradesh': 'Arunachal Pradesh',
                    'assam': 'Assam',
                    'bihar': 'Bihar',
                    'chhattisgarh': 'Chhattisgarh',
                    'goa': 'Goa',
                    'gujarat': 'Gujarat',
                    'haryana': 'Haryana',
                    'himachal-pradesh': 'Himachal Pradesh',
                    'jharkhand': 'Jharkhand',
                    'karnataka': 'Karnataka',
                    'kerala': 'Kerala',
                    'madhya-pradesh': 'Madhya Pradesh',
                    'maharashtra': 'Maharashtra',
                    'manipur': 'Manipur',
                    'meghalaya': 'Meghalaya',
                    'mizoram': 'Mizoram',
                    'nagaland': 'Nagaland',
                    'odisha': 'Odisha',
                    'punjab': 'Punjab',
                    'rajasthan': 'Rajasthan',
                    'sikkim': 'Sikkim',
                    'tamil-nadu': 'Tamil Nadu',
                    'telangana': 'Telangana',
                    'tripura': 'Tripura',
                    'uttar-pradesh': 'Uttar Pradesh',
                    'uttarakhand': 'Uttarakhand',
                    'west-bengal': 'West Bengal',
                    'andaman-nicobar': 'Andaman and Nicobar Islands',
                    'chandigarh': 'Chandigarh',
                    'dadra-nagar-haveli': 'Dadra and Nagar Haveli',
                    'daman-diu': 'Daman and Diu',
                    'delhi': 'Delhi',
                    'jammu-kashmir': 'Jammu and Kashmir',
                    'ladakh': 'Ladakh',
                    'lakshadweep': 'Lakshadweep',
                    'puducherry': 'Puducherry'
            };
            
            const selectedStateElement = document.getElementById('selectedState');
            if (selectedState && selectedStateElement) {
                const stateText = stateNames[selectedState] || selectedState;
                selectedStateElement.textContent = stateText;
            }
        }

        function downloadPDF() {
            // In a real implementation, this would trigger the actual PDF download
            alert('PDF download started! The file will be saved to your Downloads folder.');
            
            // Track conversion for analytics
            if (typeof gtag !== 'undefined') {
                gtag('event', 'download', {
                    'event_category': 'PDF',
                    'event_label': selectedState
                });
            }
        }

        // Popup Functions
        function showScrollPopup() {
            if (!hasShownScrollPopup && !localStorage.getItem('popup_shown_today')) {
                document.getElementById('popupOverlay').style.display = 'block';
                hasShownScrollPopup = true;
                
                // Set flag to not show again today
                const today = new Date().toDateString();
                localStorage.setItem('popup_shown_today', today);
            }
        }

        function showExitPopup() {
            if (!hasShownExitPopup && !localStorage.getItem('exit_popup_shown')) {
                document.getElementById('popupOverlay').style.display = 'block';
                hasShownExitPopup = true;
                localStorage.setItem('exit_popup_shown', 'true');
            }
        }

        function closePopup() {
            document.getElementById('popupOverlay').style.display = 'none';
        }

        // Event Listeners
        let scrollTimeout;
        window.addEventListener('scroll', () => {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                const scrollPercent = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
                if (scrollPercent > 60 && !hasShownScrollPopup) {
                    showScrollPopup();
                }
            }, 100);
        });

        // Exit intent detection
        document.addEventListener('mouseleave', (e) => {
            if (e.clientY <= 0) {
                showExitPopup();
            }
        });

        // Close popup when clicking outside
        document.getElementById('popupOverlay').addEventListener('click', (e) => {
            if (e.target === document.getElementById('popupOverlay')) {
                closePopup();
            }
        });

        // Initialize AdSense
        (adsbygoogle = window.adsbygoogle || []).push({});

        // Clear daily popup flags if it's a new day
        const today = new Date().toDateString();
        if (localStorage.getItem('popup_shown_today') !== today) {
            localStorage.removeItem('popup_shown_today');
        }

        // Start the loading process once the page and all resources are fully loaded.
        window.addEventListener('load', showLoadingAndPrepareDownload);
    </script>
</body>
</html>
